<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Krampstudio]]></title>
  <link href="http://krampstudio.github.com/atom.xml" rel="self"/>
  <link href="http://krampstudio.github.com/"/>
  <updated>2013-08-12T12:19:32+02:00</updated>
  <id>http://krampstudio.github.com/</id>
  <author>
    <name><![CDATA[Bertrand Chevrier]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Petite liste des outils JavaScript]]></title>
    <link href="http://krampstudio.github.com/blog/2013/02/26/petite-liste-des-outils-javascript/"/>
    <updated>2013-02-26T22:30:00+01:00</updated>
    <id>http://krampstudio.github.com/blog/2013/02/26/petite-liste-des-outils-javascript</id>
    <content type="html"><![CDATA[<p>Javascript est devenu un langage à la mode. Une profusion d&#8217;outils et de librairies fleurissent chaque jour. Lorsqu&#8217;on commence un nouveau développement, plusieurs possibilités s&#8217;offrent à nous pour composer notre <em>stack</em> côté client (et je ne parle pas du JavaScript côté serveur). Le but de ce post est de lister un certain nombre d&#8217;outils permettant de créer cette pile de librairies.</p>

<p>Cette liste n&#8217;est pas exhaustive, car elle se base tout d&#8217;abord sur les outils que j&#8217;utilise, ai utilisé ou envie d&#8217;utiliser. Le nombre de librairies JavaScript de bonne qualité croit de jour en jour et il est difficile de suivre cette frénésie. Mais j&#8217;essaierai de mettre à jour cette liste au fil de l&#8217;eau&#8230;</p>

<p><em>N&#8217;hésitez pas à m&#8217;aider à la compléter.</em></p>

<!-- more -->


<h2><a name="node"></a>node.js et npm</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/nodejs.png" title="node.js" ></p>

<p>Node.js est une implémentation JavaScript côté serveur. Node.js utilise V8, le moteur JavaScript de Chromium/Chrome, et fournit des API de développement réseau basé sur un modèle de programmation événementiel et des I/O non bloquantes.</p>

<p>Npm (<em>Node Package Manager</em>) est le gestionnaire de paquets pour node.js.</p>

<p><img class="right" src="http://krampstudio.github.com/images/tools/npm.png" title="npm" ></p>

<p>Même dans le cadre de développement client, avoir node.js sur votre machine vous permettra d&#8217;avoir à votre disposition beaucoup d&#8217;outils et de librairies distribuée sous forme de module node.js (build, qualité, instrumentation, optimisation, etc.). Grâce à npm, vous pourrez les installer et les mettre à jour très facilement. Par exemple, pour installer l&#8217;outils <em>uglify</em> (qui permet notamment de minimiser les fichiers sources), il suffira de faire un petit <code>npm install -g uglify</code>.</p>

<blockquote><p>On ne peut s&#8217;en passer</p></blockquote>

<p>Sites webs : <a href="http://nodejs.org">nodejs.org</a> et <a href="https://npmjs.org">npmjs.org</a></p>

<p>Licence : MIT</p>

<h2><a name="jquery"></a>jQuery</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/jquery.png" title="jquery" ></p>

<p>Est-il encore besoin de présenter jQuery? Au cas où vous sortez d&#8217;une longue hibernation, jQuery est le framework Javascript permettant de s&#8217;affranchir des différences entre navigateurs. Cette librairie de bas niveau permet notamment de récupérer des éléments du DOM en fonction de requêtes CSS (d&#8217;ailleurs cette seule fonctionnalité, extrêmement puissante a été externalisé dans un moteur à part: <a href="#sizzle">Sizzle</a>), de manipuler le DOM et ces événements, de faire des requêtes Ajax. jQuery fournit aussi tout un tas d&#8217;outils qui facilite la vie du développeur Javascript.</p>

<blockquote><p>Cette librairie est légère et largement répandue. Le slogan du projet  &#8221;<em>write less do more</em>&#8221; reflète bien ce qu&#8217;apporte ce framework. Ceux qui ont eu a manipuler le DOM sans ce genre de librairie peuvent évaluer jQuery à sa juste valeur.</p></blockquote>

<p>Sites web : <a href="http://jquery.com">jquery.com</a></p>

<p>Licence : MIT</p>

<h2><a name="sizzle"></a> Sizzle</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/sizzle.png" title="Sizzle" ></p>

<p>Sizzle est un projet qui a pour but de permettre de sélectionner un nœud du DOM en utilisant les sélecteurs CSS3. Sizzle est le moteur utilisé au sein de jQuery pour la partie sélection.</p>

<blockquote><p>Sizzle est très utile dès lors que l&#8217;on souhaite faire des manipulations complexes (on peut facilement créer ses propres sélecteurs) ainsi que dans le cas où vous n&#8217;utilisez que la partie sélection de jQuery, cela vous permettra de n&#8217;inclure que l&#8217;essentiel notamment dans le cadre du développement d&#8217;une librairie.</p></blockquote>

<p>Site web : <a href="http://sizzlejs.com">sizzlejs.com</a></p>

<p>Licence : MIT</p>

<h2><a name="jqueryui"></a>jQuery UI</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/jquery-ui.png" title="jQuery UI" ></p>

<p>jQuery UI est, comme son nom l&#8217;indique, une surcouche à jQuery dédiée aux composants graphiques. Cette librairie offre quelques composants prêt à l&#8217;emploi comme les sliders, les tabulations, date-pickers, etc. ainsi que des éléments plus basique pouvant servir à créer ses propres composants comme les effets, le <em>drag n&#8217;drop</em>, la gestion des positions, etc.</p>

<p>jQuery UI utilise des thèmes pour ses composants, facilement customisables grâce à son éditeur de thème en ligne: le <em>theme roller</em>.</p>

<blockquote><p>jQuery UI est une librairie de très bonne qualité et dont il faut embrasser la philosophie: utiliser les composants disponibles comme des briques de bases pour votre UI, elle n&#8217;a pas vocation a proposer une pléthore de composants de haut niveau comme le fait par exemple ExtJS.</p></blockquote>

<p>Site web : <a href="http://jqueryui.com">jqueryui.com</a></p>

<p>Licence : MIT</p>

<h2><a name="qunit"></a>QUnit</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/qunit.png" title="QUnit" ></p>

<p>QUnit est un framework de tests unitaires JavaScript orienté client. Bien que développé initialement pour tester les différents projets de la fondation jQuery, c&#8217;est un framework de test généraliste facile à utiliser et qui s&#8217;adapte bien aux tests de code client. Il propose les fonctionnalités de bases comme les assertions, le regroupement des tests ainsi que des fonctionnalités plus avancées comme les tests asynchrones ou les fixtures (une sorte de mock HTML qui permet de réaliser le test avec des éléments externes du DOM dont le code JavaScript peut dépendre).</p>

<blockquote><p>QUnit est simple, efficace et rapide à mettre en œuvre.</p></blockquote>

<p>Site web : <a href="http://qunitjs.com">qunitjs.com</a></p>

<p>Licence : MIT</p>

<h2><a name="jquerymobile"></a>jQuery Mobile</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/jquery-mobile.png" title="jQuery Mobile" ></p>

<p>jQuery Mobile est un framework d&#8217;interface graphique orienté mobile. Il propose une solution complète de création d&#8217;une interface web adaptée aux appareils mobiles (smartphones et tablettes). Cette librairie ne nécessite que peu de code JavaScript et utilise plutôt une sémantique HTML5 qui permettra de définir les éléments d&#8217;interface.</p>

<blockquote><p>jQuery Mobile est une des solutions mobile pour le web les plus facile à mettre en place. A noter tout de même des difficultés dès lors que l&#8217;on souhaite sortir du cadre définit.</p></blockquote>

<p>Site web : <a href="http://jquerymobile.com">jquerymobile.com</a></p>

<p>Licence : MIT</p>

<h2>Choisir son moteur de template Javascript</h2>

<p>Plutôt que de lister les différents moteurs de template en JavaScript, je vous renvoie vers ce <a href="http://garann.github.com/template-chooser/">site</a> plutôt sympa qui permet de choisir son moteur de <em>gabarits</em> en fonction de critères contextuels.</p>

<h2><a name="grunt"></a>Grunt</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/grunt.png" title="grunt" ></p>

<p>Grunt se définit comme un <em>task runner</em>, c&#8217;est donc un outils de <em>build</em> au sens large qui vous permettra d&#8217;automatiser un certain nombre de tâches comme la minimification des fichiers, l&#8217;orchestration des tests ou la génération de la documentation. Chaque tâche se présente sous la forme d&#8217;un plugin et il est très facile de créer ces propres tâches bien qu&#8217;il en existe déjà un nombre important. Grunt est distribué sous la forme de packages <a href="#node">node.js</a>.</p>

<blockquote><p>Grunt est vraiment un beau projet, bien pensé, bien codé et facile à étendre. C&#8217;est l&#8217;outils de build que j&#8217;utilise sur mes projets.</p>

<p>&lt;pub&gt;De plus, le <a href="https://npmjs.org/package/grunt-jsdoc">plugin jsdoc</a> est super (et a été assez facile à réaliser car les APIs sont complètes et bien documentées).&lt;/pub&gt;</p></blockquote>

<p>Site web : <a href="http://gruntjs.com">gruntjs.com</a></p>

<p>Licence : MIT</p>

<h2><a name="bower"></a> Bower</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/bower.png" title="bower" ></p>

<p>Bower est un outils de gestion de composants et de dépendances orienté navigateur. Les packages sont ni plus ni moins que des projets Github, car Bower se base uniquement sur Github comme dépôt de packages. Cela offre tous les avantages de la plate-forme : fork, clone, etc. et aussi les inconvénients : la qualité de service dépend directement de la disponibilité de Github . Les paquets ou composants ne se limitent pas à Javascript mais peuvent contenir n&#8217;importe quel type de ressource web: html, css, etc.</p>

<p>L&#8217;outils est simple à utiliser et résous les problématiques de gestion des librairies côté navigateur. Plus d&#8217;excuses pour ne pas mettre à jour une librairie et ses plugins&#8230;</p>

<blockquote><p>A mon sens, Bower manque encore un peu de maturité. Néanmoins, le projet est promis à un bel avenir; à utiliser sans modération!</p></blockquote>

<p>Site web: <a href="http://bower.io">bower.io</a></p>

<p>Licence : MIT</p>

<h2><a name="yeoman"></a>Yeoman</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/yeoman.png" title="yeoman" ></p>

<p>Yeoman est au Javascript ce que Maven est à Java: c&#8217;est un outils de gestion du cycle de vie de l&#8217;application. Il se compose de 3 outils différents et complémentaires:</p>

<ul>
<li><em>yo</em> un outils de <em>scaffolding</em>, il permet de générer des structures pour de nouvelles applications, de créer de composants pour de nombreux framework, etc.</li>
<li><a href="#bower">bower</a> qu&#8217;il utilise en interne pour la gestion des dépendances</li>
<li><a href="#grunt">grunt</a> qu&#8217;il intègre aussi pour l&#8217;automatisation des tâches et le build</li>
</ul>


<p>Site web : <a href="http://yeoman.io">yeoman.io</a></p>

<p>Licence : BSD</p>

<h2>Jake</h2>

<p>Make, Rake et &#8230; Jake c&#8217;est l&#8217;autre outils de build, d&#8217;automatisation de tâches. Il est axé sur la customisation des tâches pour votre projet, d&#8217;ailleurs il faudra mettre la main à la pâte et programmer vos tâches. Cet outils se présente sous la forme d&#8217;un module <a href="#node">node.js</a> et s&#8217;utilise autant pour un projet node qu&#8217;un projet browser.</p>

<p>Site web: <a href="https://github.com/mde/jake">mde/jake</a></p>

<p>Licence : Apache version 2.0</p>

<h2><a name="jslint"></a> JSLint</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/jslint.png" title="jslint" ></p>

<p>JSLint est un analyseur de code statique, c&#8217;est un outils qui permet de vérifier la qualité du code source Javascript.  JSLint va vérifier la conformité des sources avec des conventions de codes basée sur de bonnes pratiques de programmation, comme l&#8217;obligation de mettre des points virgules à la fin des lignes, l&#8217;utilisation de l&#8217;opérateur de vérité, la vérification des scopes, des variables globales, etc.
JSLint est déjà très répandu et il y a sûrement un plugin pour votre éditeur/IDE JavaScript favori ou votre système de build/qualité.</p>

<blockquote><p>Parfois considéré comme trop strict, JSLint est néanmoins un outils essentiel car il permet de développer en évitant les pièges du JavaScript, et de n&#8217;utiliser que <strong>The Good Parts</strong><sup>(*)</sup></p></blockquote>

<p><strong>*</strong> <em><u>JavaScript, The Good Parts, Douglas Crockford, O&#8217;Reilly, 2008</u></em> est un ouvrage de référence du langage JavaScript, son auteur est aussi le développeur de JSLint. La lecture de ce livre vous permetttra de mieux comprendre l&#8217;utilisation de certaines règles JSLint (en plus de faire de vous un dieu du JavaScript).</p>

<p>Site web : <a href="http://jslint.com">jslint.com</a></p>

<p>Licence : MIT?_</p>

<h2><a name="jshint"></a>JSHint</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/jshint.png" title="jshint" ></p>

<p>JSHint est un fork de JSLint avec pour but de rendre ce dernier plus configurable. Il permet d&#8217;autoriser certaines pratiques ou d&#8217;autres styles de programmation que celui défini par JSLint.
Une des fonctionnalité intéressante de JSHint sont les profiles, qui adaptent la vérification en fonction du contexte ou du framework utilisé (browser, jQuery, node, etc.)</p>

<blockquote><p>JSHint est un bon compromis sur un code JavaScript existant et n&#8217;ayant pas été développé avec les bonnes pratiques telles que définies par Douglas Crockford.</p></blockquote>

<p>Site web : <a href="http://jshint.com">jshint.com</a></p>

<p>Licence : MIT</p>

<h2><a name="jasmine"></a>Jasmine</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/jasmine.png" title="Jasmine" ></p>

<p>Jasmine est une librairie de tests intégrant les principes du <em>BDD</em> (<em>Behavior Driven Developement</em>), elle ne dépend d&#8217;aucune autre librairies et peut être utilisée aussi bien pour tester un contexte client que serveur (node) et s&#8217;intègre avec de nombreuses plates-formes.</p>

<blockquote><p>Jasmine est un des framework de test de référence en JavaScript.</p></blockquote>

<p>Site web : <a href="http://pivotal.github.io/jasmine/">pivotal.github.io/jasmine</a></p>

<p>Licence : MIT</p>

<h2>Phantom.js</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/phantomjs.png" title="Phantom.js" ></p>

<p>Phantom.js est un des outils qu&#8217;il est nécessaire d&#8217;installer sur sa machine. Cette libraire est un navigateur WebKit sans interface graphique (<em>headless</em>). Phantom.js permet notamment de faire tourner des tests JavaScript clients depuis un terminal, sur un serveur et surtout de lancer des suites de tests sans dépendre d&#8217;un navigateur classique. Phantom.js expose une API et est donc scriptable.</p>

<blockquote><p>Incontournable si vous utilisez un outils de build.</p></blockquote>

<p>Site web : <a href="http://phantomjs.org/">phantomjs.org</a></p>

<p>Licence : BSD</p>

<h2><a name="karma"></a>Karma</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/karma.png" title="Karma" ></p>

<p>Précédemment nommé Testacular, Karma est un utilitaire permettant de faciliter l&#8217;exécution des tests en JavaScript. Karma vous permettra de configurer, de piloter et d&#8217;intégrer vos suites de tests. Quelques fonctionnalités peuvent vous faciliter la vie comme le contrôle des navigateurs.</p>

<blockquote><p>Karma est fait pour s&#8217;intégrer à votre projet quelque soit les librairies déjà utilisées.</p></blockquote>

<p>Site web : <a href="http://karma-runner.github.io">karma-runner.github.io</a></p>

<p>Licence : MIT</p>

<h2><a name="modernizr"></a>Modernizr</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/modernizr.png" title="Modernizr" ></p>

<p>Modernizr est une librairie de détection de fonctionnalités HTML5 et CSS3. Elle permet de vérifier pour le navigateur courant si une fonctionnalité particulière est présente ou non, car comme nous le savons tous, la détection par type de navigateur est à proscrire.</p>

<blockquote><p>Cet outils doit être utilisé dès que l&#8217;on souhaite faire du HTML5 et/ou CSS3.</p></blockquote>

<p>Site web : <a href="http://modernizr.com/">modernizr.com</a></p>

<p>Licence : MIT</p>

<h2><a name="underscore"></a>Underscore.js</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/underscore.png" title="underscore.js" ></p>

<p>Underscore.js est un framework généraliste qui augmente le langage avec un certain nombre d&#8217;utilitaires fait pour vous faciliter la vie. Il est difficile de synthétiser son contenu car très hétéroclite, il permet autant de faire du map/reduce sur des collections que de la memoization de fonction ou de la manipulation de strings. Underscore va simplement vous éviter de réécrire pas mal de fonctions qui ne sont pas incluses dans le langage.</p>

<blockquote><p>Underscore est au _  ce que jQuery est au $</p></blockquote>

<p>Site web: <a href="http://underscorejs.org/">underscorejs.org</a></p>

<p>Licence : MIT</p>

<h2><a name="requirejs"></a>Require.js</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/require-js.png" title="require.js" ></p>

<p>Require.js est une librairie qui permet de pallier à une lacune du langage JavaScript: la gestion des librairies, des dépendances et des imports. Pour cela, Require.js implémente la spécification <a href="https://github.com/amdjs/amdjs-api/wiki/AMD">AMD</a> (Asynchronous Module Definition) et est aussi compatible <a href="http://www.commonjs.org/">CommonJs</a>. Grâce à Require.js, vous pouvez définir des <em>modules</em> et importer ces modules depuis d&#8217;autres modules. La notion de dépendance entre module est gérée et le chargement peut se faire ne mode synchrone ou asynchrone (le module est chargé au moment où il est importé).</p>

<blockquote><p>Require.js vous offre un système aussi puissant que ceux présents dans d&#8217;autres langages. Il est optimisable, et s&#8217;intègre facilement avec de nombreuses librairies.</p></blockquote>

<p>Site web: <a href="http://requirejs.org/">requirejs.org</a></p>

<p>Licence : BSD</p>

<h2><a name="jsdoc"></a>jsdoc</h2>

<p>Cette librairie permet de générer une documentation du code source JavaScript à partir des commentaires. JsDoc propose un formalisme des commentaires permettant une unification au sein des sources. La documentation finale prend la forme d&#8217;un site internet, qu&#8217;il est possible de customiser grâce à des templates.</p>

<blockquote><p>Bien que souffrant encore de quelques lacunes, cette librairie permet de couvrir bon nombre de pratiques diverses et variées dues à la souplesse du langage.</p></blockquote>

<p>Site web: <a href="http://usejsdoc.org/">usejsdoc.org</a></p>

<p>Licence : BSD</p>

<h2><a name="uglifyjs"></a>UglifyJS</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/uglifyjs.png" title="UglifyJS" ></p>

<p>UglifyJS est une librairie de minimification et de compression de code source JavaScript écrit en JavaScript. Cette librairie est performante et offre des résultats très satisfaisant. Elle se distingue des alternatives car elle offre des APIs de parsing et de manipulation du code source basées sur le pattern <em>AST</em> (Abstract Syntax Tree).</p>

<blockquote><p>UglifyJS est un choix à considérer sérieusement dans le choix d&#8217;un outils de compression des sources.</p></blockquote>

<p>Site web: <a href="http://lisperator.net/uglifyjs/">lisperator.net/uglifyjs</a></p>

<p>Licence : BSD</p>

<h2><a name=""></a>Raphaël</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/raphael.png" title="Raphaël" ></p>

<p>Raphaël est une librairie de dessin graphique vectoriel pour le web. Elle utilise soit SVG, soit VML comme technologie de rendu pour être compatible avec un grand nombre de navigateur. Raphaël propose une API généraliste de maniuplation de dessin vectoriel (formes, chemins, couleurs, animations, etc.) et d&#8217;intéraction utilisateur. Il existe de nombreux <em>plugins</em> ou projets se basant sur Raphaël pour fournir des services de plus haut niveaux (charts, etc.)</p>

<blockquote><p>Raphaël est un sérieux conccurent aux canvas et peut être même un remplaçant à Flash&#8230;</p></blockquote>

<p>Site web: <a href="http://raphaeljs.com/">raphaeljs.com</a></p>

<p>Licence : MIT</p>

<h2><a name="prototype"></a>Prototype.js</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/prototype.png" title="Prototype.js" ></p>

<p>Prototype est une des première librairie JavaScript fournissant des services cross-browser de haut niveau tels que la manipulation du DOM ou les requêtes AJAX.</p>

<blockquote><p>Bien qu&#8217;aujourd&#8217;hui jQuery ait remplacé Prototype dans bon nombre de projets, il reste néanmoins des points très intéressant qu&#8217;il est bon de connaître.</p></blockquote>

<p>Site web: <a href="http://prototypejs.org/">prototypejs.org</a></p>

<p>Licence : MIT</p>

<h2>Script.aculo.us</h2>

<p><img class="right" src="http://krampstudio.github.com/images/tools/scriptaculous.png" title="Script.aculo.us" ></p>

<p>Script.aculo.us est à Prototype ce que jQuery UI est à jQuery: il l&#8217;augmente de fonctionnalités dédiées à l&#8217;interface graphique: effets, drag n&#8217;drop, widgets, etc.</p>

<blockquote><p>Tout comme Prototype, Script.aculo.us fut en sont temps incontournable</p></blockquote>

<p>Site web: <a href="http://script.aculo.us/">script.aculo.us</a></p>

<p>Licence : MIT</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[L'effet Github]]></title>
    <link href="http://krampstudio.github.com/blog/2013/02/18/github-effect/"/>
    <updated>2013-02-18T12:33:00+01:00</updated>
    <id>http://krampstudio.github.com/blog/2013/02/18/github-effect</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://krampstudio.github.com/images/github.png" title="GitHubLogo" ></p>

<p>J&#8217;ai créé mon <a href="https://github.com/krampstudio">compte Github</a> le 5 novembre 2010. Ce que je cherchais : seulement un hébergement pour mes dépôts GIT, voire une sorte de Sourforge. J&#8217;étais loin de me douter que ce service allait profondément modifier ma façon de développer. Après avoir été initié à GIT en 2008, je souhaitais juste pouvoir <em>backuper</em> mes dépôts locaux et y accéder de partout. Je précise les dates, car à ce moment, je n&#8217;avais pas la moindre idée de ce qu&#8217;était vraiement Github et de ce qu&#8217;il allait devenir.</p>

<!-- more -->


<p>Effectivement, c&#8217;est beaucoup plus tard que je me suis rendu compte de tous les services sous-jacent et notamment du côté <em>social</em> de Github: la facilité déconcertante avec laquelle on peut contribuer à un projet. Pas besoin de s&#8217;inscrire à une mailing list, de lire le manuel du contributeur pour soumettre un patch. Avec Github, le <em>fork</em> et le <em>pull request</em>  encouragent grandement à la contribution. Un bug, une fonctionalité manquante à un projet, je fork et je modifie. Je souhaite reverser mes modifications à l&#8217;auteur je pull request. L&#8217;open source comme on l&#8217;avait rêvé. Il y a tout de même un question que je me pose fréquement: certains dépôts n&#8217;ont pas de licences, et dans ce cas, bien que le dépôt soit public, a-t-ont le droit de forker, de modifier et donc de redistribuer (je parle des dépôts publics) ?</p>

<p>Aujourd&#8217;hui Github comme plusieurs millions d&#8217;utilisateurs et de dépôts! Le tout web utilise Github et bien plus.</p>

<p>Dans mon cas, Github me sert à</p>

<ul>
<li>Avoir un dépôt Git distant</li>
<li>Gérer la documentation de mes projets (wiki)</li>
<li>Gérer les tickets (iusses)</li>
<li>Contribuer à des projets tiers (fork et pull request)</li>
<li>Repackager sous Github des projets tiers</li>
<li>Héberger ce présent blog ainsi que les mini-sites de mes projets (GitHub pages)</li>
<li>Suivre des dépôts et des développeurs</li>
<li>Utiliser Github comme dépôt de packages</li>
<li>Notification de services tiers (via les hooks)</li>
<li>Frounisseur d&#8217;authentification sur d&#8217;autres sites (via Oauth 2)</li>
</ul>


<p>Et je suis sûr que je n&#8217;utilise pas tout&#8230;</p>

<p><strong> Dé Re centralier </strong></p>

<p><img class="right" src="http://krampstudio.github.com/images/setuptocat.png" title="Octocat" ></p>

<p>J&#8217;ai lu des postes de personnes se plaigant des récentes coupures du service. Ma première réaction a été de me demander quel était le problème, de me dire que certaines personnes n&#8217;avaient rien compris au mode décentralisé: on peut travailler sur notre dépôt local et pousser dès le service est <em>up</em> à nouveau, au pire on ne peut pas mettre à jour ses <em>issues</em>. C&#8217;est le principe d&#8217;un outils décentralisé. Mais dernièrement, j&#8217;ai commencé à utiliser des services de dépôts de paquets construits autout de Github: <a href="http://npmjs.org">NPM</a> pour les paquets node.js et <a href="http://twitter.github.com/bower">Bower</a> pour les dépendances Javascript clientes. NPM a son propre <a href="http://registry.npmjs.org">serveur de paquet</a>, mais il est possible de faire pointer une dépendance directement sur un dépôt Github. Bower, lui, utilise Github comme source pour télécharger les dépendances, et là dès que Github est en maintenance, impossible d&#8217;installer la moindre dépendance. C&#8217;est plutôt embarrassant. J&#8217;aime beaucoup le principe du serveur de paquets, que j&#8217;utilise autant côté système (Debian) ou pour le développement (Maven) et à vrai dire je n&#8217;ai jamais eu le moindre soucis, peut être à cause du principe de serveurs mirroirs répartis autour du monde (en tout cas chez Debian). Peut être Github devrait faire la même chose, au moins pour limiter les dégâts en cas d&#8217;interruption de service. J&#8217;aime beaucoup Github, leurs services, leur société, leur vision, mais maintenant beaucoup de projets de dépendent très fortement d&#8217;eux et si un jour ca s&#8217;arrête quel seront les impacts? Heureusement qu&#8217;il ne s&#8217;agit pas de SvnHub ou CvsHub</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Pluginifier vos composants jQuery]]></title>
    <link href="http://krampstudio.github.com/blog/2012/11/27/pluginifier-vos-composants-jquery/"/>
    <updated>2012-11-27T23:02:00+01:00</updated>
    <id>http://krampstudio.github.com/blog/2012/11/27/pluginifier-vos-composants-jquery</id>
    <content type="html"><![CDATA[<p>C&#8217;est en développant l&#8217;interface d&#8217;un de mes projets persos, que je me suis dit: <em>&#8220;Ces composants graphiques que tu fait là, pourquoi ne pas en faire de vrais plugins jQuery, et tout et tout!&#8221;</em>. C&#8217;est alors que tout s&#8217;enchaîne: création d&#8217;un dépôt sur Github, recherche des outils, j&#8217;ai fait un, puis deux, je présente ça devant mes collègues au travail, et pour finir un petit post en <em>&quot;bonnet de forme&quot;</em>&#8230;</p>

<!-- more -->


<p>Le principe est simple: j&#8217;utilise HTML, CSS et la librairie jQuery ainsi que son acolyte jQuery-UI pour développer les interfaces graphiques de mes webapps. Au fur et à mesure des développements, je suis passé de <em>tout faire dans le même script</em> (tout imbriqué) à commencer à utiliser les plugins jQuery dans l&#8217;application, puis à en faire des projets autonomes.</p>

<p>Dans ce post, je vais essayer de <em>pluginifier</em> pas à pas, un petit composant utilisé pour supprimer graphiquement un élément de l&#8217;interface.</p>

<h2>Environnement</h2>

<p>En premier lieu, les requis:</p>

<ul>
<li>Un système d&#8217;exploitation avec un Shell de type Bash (Dash, Ksh, Zsh devraient faire l&#8217;affaire) pour les autres, il faudra trouver une alternative de type Cygwin ou équivalent.</li>
<li>Disposer des droits root/admin sur ce système.</li>
<li>Git installé (optionnel) mais ca vous permettra d&#8217;aller chercher les exemples sur GitHub.</li>
<li>Un éditeur de texte.</li>
</ul>


<p>Pour réaliser ce post, j&#8217;ai utilisé Ubuntu 12.04, Precise Pangolin.</p>

<h3>Node.js &amp; NPM</h3>

<blockquote><p>Mais c&#8217;est quoi le rapport entre jQuery et Node.js? Là je ne comprend plus rien!</p></blockquote>

<p>En fait, on a besoin de <a href="http://nodejs.org">node.js</a>, pour installer notre système de build. Il y a pas mal de librairies JavaScript en CLI qui utilisent node.js. De plus le système de paquet de node, <a href="http://npmjs.org">npm</a>  étant plutôt pas mal, va faciliter l&#8217;installation des ces librairies. Par ailleurs, quand on développe en Javascript, même pour du développement client, c&#8217;est une bonne chose d&#8217;avoir node.js installé, car on peut profiter de tout un tas d&#8217;outils sympa.</p>

<p>Pour installer node.js et npm sous Debian/Ubuntu:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$&gt;</span> sudo aptitude install nodejs npm
</span></code></pre></td></tr></table></div></figure>


<p>Pour les autres, vous pouvez vous reporter au site de <a href="http://nodejs.org/download/">node.js</a></p>

<h3>Grunt</h3>

<p><img class="right" src="http://krampstudio.github.com/images/grunt.png" title="Grunt" ></p>

<p>Une fois la commande npm disponible, il va falloir installer <a href="http://gruntjs.com">Grunt</a>, l&#8217;outils que nous utiliserons pour automatiser les tâches de build de notre plugin. Nous allons donc l&#8217;installer avec npm, en mode <em>global</em> (donc accessible pour tous les utilisateurs), d&#8217;où le commutateur <code class='inline'>g</code>. C&#8217;est pourquoi il faut l&#8217;installer avec les droits root.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$&gt;</span> sudo npm install -g grunt
</span></code></pre></td></tr></table></div></figure>


<h3>Phantom.js</h3>

<p><img class="right" src="http://krampstudio.github.com/images/phantomjs.png" title="Phantom.js" ></p>

<p>Le dernier outils a installer sur votre système est <a href="http://phantomjs.org">Phantom.js</a>, qui va nous servir pour simuler un browser durant nos tests. Il est aussi disponible depuis le gestionnaire de paquet sur les distributions récentes:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$&gt;</span> sudo aptitude install phantomjs
</span></code></pre></td></tr></table></div></figure>


<p>ou en le téléchargeant depuis le <a href="http://phantomjs.org/download.html">site web</a>, dans ce cas, ne pas oublier de le rajouter dans le <code class='inline'>PATH</code>.</p>

<h2>Les choses sérieuses</h2>

<p>Voici un exemple de code intégré à un script d&#8217;une application:</p>

<div><script src='https://gist.github.com/3854836.js?file=dynamic-removable-list.js'></script>
<noscript><pre><code>$(document).ready(function(){
            
//get list id
var listId = ('#list').val();

//retrieve items
$.post('/list/articles', {list: listId}, function(articles){

    //create a list dynamically
    var $list = $('#items &gt; ul');
    for (var index in articles){

        //add an item
        var article = articles[index];
        var shortDesc = article.description;
        if(article.description.length &gt; 100){
            shortDesc = shortDesc.substring(0,95) + '[...]';
        }
        var $item = $(&quot;\
            &lt;li&gt;\
                &lt;div class='item-title'&gt;&quot;+article.name+&quot;&lt;/div&gt;\
                &lt;img class='item-thumbnail' src='http://krampstudio.github.com/imgs/articles/&quot;+article.thumb+&quot;' alt='' /&gt;\
                &lt;div class='item-desc'&gt;&quot;+shortDesc+&quot;&lt;/div&gt;\
            &lt;/li&gt;\
        &quot;);
        
        //make the item removable
        
        //remove controls
        var $rmCtrl = $(&quot;&lt;img class='removable-ctrl' src='imgs/delete.png' alt='remove' title='Remove'&gt;&quot;);
        $rmCtrl.css({
            'display' : 'none',
            'position'  : 'absolute',
            'right' : '5px',
            'top'   : '5px',
            'cursor'    : 'pointer'
            })
            .click(function(){
                if(confirm(&quot;Remove this item?&quot;)){
                    $item.remove();
                }
            });
        $item.append($rmCtrl)
            .mouseover(function(){
                $('.removable-ctrl', $(this)).show();
            })
            .mouseout(function(){
                $('.removable-ctrl', $(this)).hide();
            });
      
        
        $list.append($item);
    }

}, 'json');
        
});</code></pre></noscript></div>


<p>Cet exemple est utilisé pour créer une liste HTML en fonction du résultat d&#8217;une requête Ajax. Chaque item de la liste doit pouvoir être supprimé par la suite. C&#8217;est ce point qui nous intéresse, car nous voulons pouvoir appliquer ce composant de suppression à d&#8217;autres parties de notre interface graphique.</p>

<p>Nous allons procéder en suivant ces étapes:</p>

<ol>
<li>Trouver un nom au plugin.</li>
<li>Générer une structure, un archétype pour notre plugin.</li>
<li>Refactorer notre code au sein d&#8217;un plugin.</li>
<li>Créer une page d&#8217;exemple dédié.</li>
<li>Créer un ensemble de tests unitaires.</li>
<li>Définir notre séquence de build.</li>
<li>L&#8217;indexer le site des plugin jQuery.</li>
</ol>


<h2>Trouver un nom qui déchire</h2>

<p>Alors, voici ma <em>bête noire</em> de la programmation: trouver des noms aux variables, classes, projets! Je n&#8217;ai pas ce côté inventif qui va permettre de trouver le nom d&#8217;animal super cool, donc je reste très terre à terre. Notre plugin s&#8217;appellera <em>RemoveableArea</em>! super&#8230; :-(. Si quelqu&#8217;un à une meilleure idée, je suis preneur.</p>

<blockquote><p>Ca c&#8217;est fait.</p></blockquote>

<h2>Générer la structure du projet</h2>

<p>L&#8217;avantage d&#8217;utiliser un outil tel que Grunt c&#8217;est qu&#8217;il fait une part de notre travail, donc quand on est fainéant, on ne peut plus s&#8217;en passer.
Grunt dispose d&#8217;une tâche <code class='inline'>init</code> qui permet de générer une structure de projet type en partant d&#8217;un template. Et ça tombe bien, il y en a un pour jQuery.</p>

<p>Dans l&#8217;ordre, on va:
1. Créer un répertoire pour notre plugin.
2. Le versionner avec GIT.
3. Générer la structure de base.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>mkdir removablearea
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>removablearea
</span><span class='line'><span class="nv">$ </span>git init
</span><span class='line'>Initialized empty Git repository in /home/bertrand/dev/workspace/removablearea/.git/
</span><span class='line'><span class="nv">$ </span>grunt init:jquery
</span><span class='line'><span class="c">#answer the questions about the plugin</span>
</span><span class='line'><span class="c">#...</span>
</span><span class='line'>Initialized from template <span class="s2">&quot;jquery&quot;</span>.
</span><span class='line'>Done, without errors.
</span><span class='line'><span class="nv">$ </span>git add -A
</span><span class='line'><span class="nv">$ </span>git commit -m <span class="s2">&quot;Create base plugin&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Voilà, maintenant, notre structure est générée, le projet est versionné avec GIT, et si vous avez renseigné soigneusement les questions demandées par Grunt, alors un certain nombre de sections sont déjà pré-remplies.</p>

<p>Normalement, vous devriez avoir l&#8217;arborescence suivante:</p>

<pre>
.
├── grunt.js                  //fichier de build
├── libs                      //librairies externes
│   ├── jquery
│   │   └── jquery.js
│   ├── jquery-loader.js
│   └── qunit
│       ├── qunit.css
│       └── qunit.js
├── LICENSE-GPL                   //licenses
├── LICENSE-MIT
├── package.json              //meta données du projet
├── README.md                 
├── removablearea.jquery.json //meta données du plugin
├── src                           //sources du plugin
│   └── removablearea.js
└── test                      //tests unitaires
    ├── removablearea.html
    └── removablearea_test.js
</pre>


<p>Nous allons modifier un peu cette structure, en y ajoutant un répertoire <span class="inline-code">sample</span> dans lequel nous allons créer des exemples d&#8217;utilisation de notre plugin.</p>

<h2>Pluginification</h2>

<p>Dans un premier temps, nous allons créer la structure (au sens du typage en programmation) de notre plugin jQuery, en se basant sur les bonnes pratiques détaillée dans la <a href="http://docs.jquery.com/Plugins/Authoring" title="jQuery Plugin AUthoring">documentation jQuery</a> à ce propos. Nous allons donc utiliser la structure suivante, comme base de notre fichier <span class="inline-code">src/removablearea.js</span>:</p>

<div><script src='https://gist.github.com/3886198.js?file=removablearea.js'></script>
<noscript><pre><code>(function($) {
    &quot;use strict&quot;;

    var RemovableArea = {
        _opts : {
            label       : 'Supprimer',
            img         : '/imgs/delete.png',
            warning     : 'Voulez-vous supprimer cet élément?',
            hoverClass  : 'half-opac'
        },
        _init: function(options){
            var opts = $.extend(true, {}, RemovableArea._opts, options);
            return this.each(function() {
            
            });
        },
        destroy : function(){
            this.each(function() {

            });
        }
    };

    $.fn.removableArea = function( method ) {
        if (RemovableArea[method]) {
            if(/^_/.test(method)){
                $.error( 'Trying to call a private method ' + method + ' on jQuery.pluginName' );
            } else {
                return RemovableArea[method].apply( this, Array.prototype.slice.call( arguments, 1 ));
            }
        } else if ( typeof method === 'object' || ! method ) {
            return RemovableArea._init.apply( this, arguments );
        } else {
            $.error( 'Method ' +  method + ' does not exist on jQuery.removableArea' );
        }
    };

}(jQuery));</code></pre></noscript></div>


<p>Tout d&#8217;abord, on peut remarquer que le code est englobé dans une closure. Ce pattern s&#8217;appelle <em>Immediately-Invoked Function Expression</em> (ou <em>LIFE</em>). Cette pratique permet d&#8217;éviter d&#8217;exécuter du code dans le scope global. Dans le cas de jQuery, cet usage permet d&#8217;utiliser le symbole dollar en étant sûr qu&#8217;il vient de jQuery et non d&#8217;un autre framework, le <span class="inline-code">$</span> est mappé à l&#8217;objet <span class="inline-code">jQuery</span> :</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">$</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">//your code</span>
</span><span class='line'><span class="p">})(</span> <span class="nx">jQuery</span> <span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Un autre point que l&#8217;on peut souligner est ce string utilisé à la ligne 2:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>   <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>La présence de ce string permet de passer le moteur Javascript en mode <em>strict</em>, qui le rend moins tolérant à certaines pratiques du langage. Vous pouvez consulter la <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/Strict_mode">documentation Mozilla</a> pour plus de détails sur ce mode.</p>

<p>Ensuite la partie qui permet de créer le plugin jQuery peut se résumer à cette ligne:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">removableArea</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">method</span> <span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Littéralement, nous ajoutons à l&#8217;attribut <code class='inline'>fn</code> de l&#8217;objet <code class='inline'>jQuery</code> (ou <code class='inline'>$</code> pour les intimes), la fonction <code class='inline'>removableArea</code> qui prend en paramètre un nom de méthode. C&#8217;est grâce à cette ligne que nous pourrons appeler la fonction <code class='inline'>removableArea</code> sur un élément du DOM, comme <code class='inline'>$('.boo > #far').removableArea(options);</code>.</p>

<p>Ensuite le contenu de cette fonction va tout simplement déléguer les appels à l&#8217;objet <code class='inline'>RemovableArea</code> définit au préalable, en fonction du contexte d&#8217;appel:</p>

<ul>
<li><code class='inline'>removableArea</code> est appelé avec un objet en paramètre (les options):

<ul>
<li>On délègue à <code class='inline'>RemovableArea.init(options)</code>.</li>
</ul>
</li>
<li><code class='inline'>removableArea</code> est appelé avec un string en paramètre:

<ul>
<li>Ce string correspond à une méthode de <code class='inline'>RemovableArea</code>, alors on délègue, sauf si ce nom commence par un <em>underscore</em> (genre de méthode privée).</li>
</ul>
</li>
<li><code class='inline'>removableArea</code> est appelé sans paramètre, on lève une erreur.</li>
</ul>


<p>Grâce à ce mécanisme de paramètres, nous pouvons appeler des méthodes à partir du même plugin:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>    <span class="kd">var</span> <span class="nx">elt</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#id&#39;</span><span class="p">).</span><span class="nx">removableArea</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">elt</span><span class="p">.</span><span class="nx">removableArea</span><span class="p">(</span><span class="s1">&#39;destroy&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Refactoring</h2>

<p>Maintenant, que nous avons la structure de notre plugin en place, nous allons y intégrer notre code. Pour cela, il faut se poser les questions suivantes:</p>

<ul>
<li>Quelles sont les options demander à l&#8217;utilisateur et quelles seront les valeurs par défaut ?</li>
<li>Comment répartir notre code entre la méthode par défaut (<code class='inline'>RemovableArea.init(options)</code>) et d&#8217;autres méthodes ?</li>
<li>Quels événements déclencher pour aider à l&#8217;implémentation du plugin ?</li>
</ul>


<h3>Les options</h3>

<p>Par convention, le paramétrage des plugins se fait en passant un objet contenant les options pour initialiser le plugin. Le code suivant va permettre d&#8217;initialiser le composant de notre exemple:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">removableArea</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">label</span>       <span class="o">:</span> <span class="s1">&#39;Supprimer&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">img</span>         <span class="o">:</span> <span class="s1">&#39;/imgs/delete.png&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">warning</span>     <span class="o">:</span> <span class="s1">&#39;Voulez-vous supprimer cet élément?&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">hoverClass</span>  <span class="o">:</span> <span class="s1">&#39;half-opac&#39;</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Nous avons donc définis un certain nombre de paramètres, comme l&#8217;image du <em>bouton</em> qui s&#8217;affichera pour supprimer la zone ou les différents labels. On permet aussi de définir la classe CSS qui s&#8217;appliquera sur ce <em>bouton</em> au passage de la souris.</p>

<h3>Les paramètres par défaut</h3>

<p>Une fois le liste des options définies, il faut leur donner des valeurs par défaut. Cela permet d&#8217;éviter de redonner toutes les options à chaque utilisation, et permet surtout de mettre en place un comportement par défaut. L&#8217;idée est que le plugin fonctionne tout de suite, mais de laisser la possibilité de le modifier plus tard.</p>

<p>Pour faire cela, nous allons utiliser un méthode de jQuery qui est très utile: <code class='inline'>$.extend</code> qui permet de <em>merger</em> les options passées en paramètres et les options par défaut.</p>

<p>Nous allons donc définir ces paramètres par défaut dans un attribut de notre objet <code class='inline'>RemovableArea</code>, puis les étendre avec les paramètres passés au plugin:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>   <span class="kd">var</span> <span class="nx">RemovableArea</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">_opts</span> <span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">label</span> <span class="o">:</span> <span class="s1">&#39;Supprimer&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">img</span> <span class="o">:</span> <span class="s1">&#39;/imgs/delete.png&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">warning</span> <span class="o">:</span> <span class="s1">&#39;Voulez-vous supprimer cet élément?&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">hoverClass</span> <span class="o">:</span> <span class="s1">&#39;half-opac&#39;</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>      <span class="nx">_init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">){</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">opts</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="p">{},</span> <span class="nx">RemovableArea</span><span class="p">.</span><span class="nx">_opts</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</span><span class='line'>          <span class="c1">//...</span>
</span><span class='line'>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>Grâce au résultat de la méthode <code class='inline'>$.extend</code> la variable <code class='inline'>opts</code> contient les options passées par l&#8217;utilisateur ou leur valeur par défaut s&#8217;ils ont été omis.</p>

<h3>Le code du plugin</h3>

<p>Maintenant, que nous avons une structure à notre plugin, la gestion des paramètres et options, il va falloir répartir le code entre la méthode d&#8217;initialisation et d&#8217;autres méthodes que nous rajoutons en fonction du fonctionnement souhaité. L&#8217;approche que je met souvent en place est de tout faire dans un premier temps dans la méthode d&#8217;initialisation, puis je refactor au fur et à mesure (le problème est qu&#8217;il m&#8217;arrive de n&#8217;avoir jamais le temps de refactorer&#8230;).</p>

<p>Pour notre exemple, nous allons créer les éléments du DOM dans la méthode d&#8217;initialisation et une méthode <code class='inline'>destroy</code> pour supprime tout ce que le plugin a créé.</p>

<div><script src='https://gist.github.com/4114309.js?file=removablearea.js'></script>
<noscript><pre><code>(function($) {
    &quot;use strict&quot;;

    var RemovableArea = {
        _opts : {
            label       : 'Supprimer',
            img         : 'imgs/delete.png',
            warning     : 'Voulez-vous supprimer cet élément?',
            hoverClass  : 'half-opac'
        },
        _ctrlClass : 'removable-ctrl',
        _init: function(options){
            var opts = $.extend(true, {}, RemovableArea._opts, options),
                ctrlClass = RemovableArea._ctrlClass;

            return this.each(function() {
                var $elt = $(this);
                if($elt.css('position') != 'relative'){
                    $elt.css('position', 'relative');
                }
                var $ctrl = $(&quot;&lt;img class='&quot;+ctrlClass+&quot;' src='&quot;+opts.img+&quot;' alt='&quot;+opts.label+&quot;' title='&quot;+opts.label+&quot;'&gt;&quot;);
                $ctrl.css({
                        'display'   : 'none',
                        'position'  : 'absolute',
                        'right'     : '5px',
                        'top'       : '5px',
                        'cursor'    : 'pointer'
                    })
                    .hover(function(){
                        $(this).addClass(opts.hoverClass);
                    }, function(){
                        $(this).removeClass(opts.hoverClass);
                    });
                
                $elt.append($ctrl)
                    .mouseover(function(){
                        $('.' + ctrlClass, this).show();
                    }) 
                    .mouseout(function(){
                        $('.' + ctrlClass, this).hide();
                    });
                $ctrl.click(function(){
                    if(opts.warning === false || confirm(opts.warning)){
                        $elt.trigger('removed.removablearea');
                        $elt.remove();
                    }
                });
                $elt.trigger('init.removablearea');
            });
        },
        destroy : function(){
            this.each(function() {
                $('.' + RemovableArea._ctrlClass, $(this)).remove();
            });
        }
    };

    $.fn.removableArea = function( method ) {
        if (RemovableArea[method]) {
            if(/^_/.test(method)){
                $.error( 'Trying to call a private method ' + method + ' on jQuery.pluginName' );
            } else {
                return RemovableArea[method].apply( this, Array.prototype.slice.call( arguments, 1 ));
            }   
        } else if ( typeof method === 'object' || ! method ) {
            return RemovableArea._init.apply( this, arguments );
        } else {
            $.error( 'Method ' +  method + ' does not exist on jQuery.removableArea' );
        }
    };

}(jQuery));</code></pre></noscript></div>


<p>Voilà donc notre plugin créé! On peut aussi noter l&#8217;ajout de deux événements : le premier étant déclenché à l&#8217;initialisation du plugin et le second lors de la suppression. Le nom des événements est suffixé par <em>removablearea</em>, qui est une manière de les grouper dans des <a href="http://docs.jquery.com/Namespaced_Events">namespaces</a>.</p>

<h2>Mise en oeuvre : créer une page d&#8217;exemple</h2>

<p>Bon rien de bien compliqué ici, je créé juste une page HTML basique qui charge jQuery et notre plugin. Le principe est d&#8217;avoir un cas d&#8217;utilisation classique du plugin.
Pour notre plugin, je créé cette page dans le répertoire <code class='inline'>sample</code> et je la publie avec <a href="http://pages.github.com/">Github-Pages</a> (ce qui est bien pratique). Jetez donc un oeil à cet <a href="http://krampstudio.com/jQueryRemovableArea/index.html">exemple</a> et aux sources <code class='inline'>Ctrl-U</code>.</p>

<h2>Tester du Javascript</h2>

<blockquote><p>Tester c&#8217;est douter :-S</p></blockquote>

<p>On voit trop rarement des tests mis en place pour le code Javascript, mais pourtant tous les outils dont nous avons besoin sont disponibles (il y a en a même pas mal!). Donc comme pour n&#8217;importe quel autre langage, nous allons créer des tests unitaires automatisés pour notre plugin.</p>

<p><img class="right" src="http://krampstudio.github.com/images/qunitjs.png" title="Grunt" >
Parmi les nombreux frameworks existant, mon dévolu c&#8217;est posé sur <a href="http://www.qunitjs.org">Qunit</a> car c&#8217;est le framework de tests de jQuery d&#8217;une part (donc il s&#8217;intègre naturellement avec un plugin jQuery) et d&#8217;autre part parce qu&#8217;il offre toutes les fonctionnalités dont nous avons besoin: tests asynchrones, <em>fixtures</em>, groupes, etc.</p>

<p>Le test se compose de deux fichiers:</p>

<ul>
<li>Un fichier HTML, qui contient:

<ul>
<li>Une structure de base à ne pas modifier</li>
<li>Un bloc <em>fixtures</em> dont l&#8217;identifiant est <code class='inline'>qunit-fixture</code>. C&#8217;est dans ce bloc uniquement que nous pouvons inclure nos éléments liés à notre test. Le contenu de ce bloc n&#8217;est pas visible et sera rechargé après l&#8217;exécution de chaque méthode de test.</li>
</ul>
</li>
<li>Un fichier Javascript qui va contenir notre test.</li>
</ul>


<p>Du point de vue de l&#8217;API de test, Qunit nous propose:</p>

<ul>
<li>D&#8217;organiser les tests en modules. Les tests peuvent partager des attributs lorsqu&#8217;ils sont groupés en module.</li>
<li>Un ensemble de fonctions comparables à des assertions, comme <code class='inline'>ok( boolean )</code>, <code class='inline'>equal(expected, compared)</code>, etc.</li>
<li>Des méthodes pour tester des méthodes asynchrones.</li>
</ul>


<p>Testons notre plugin!</p>

<p>Tout d&#8217;abord, nous créons dans les <em>fixtures</em> trois blocs qui vont nous servir comme zones de suppression:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'> <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;qunit-fixture&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div&gt;</span>lame test markup<span class="nt">&lt;/div&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div&gt;</span>normal test markup<span class="nt">&lt;/div&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div&gt;</span>awesome test markup<span class="nt">&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ensuite, nous définissons un module dans le test. L&#8217;ordre d&#8217;invocation des méthodes est important, car toutes les méthodes de test définies après la déclaration du module feront parties de ce module. Ce module va aussi se charger d&#8217;initialiser l&#8217;attribut <code class='inline'>targets</code> que nous faisons pointer sur les zones à supprimer, et nous pourrons utiliser cet attributs dans tous les tests du module.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>   <span class="nx">module</span><span class="p">(</span><span class="s1">&#39;jQuery#removableArea&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">setup</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">targets</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#qunit-fixture&#39;</span><span class="p">).</span><span class="nx">children</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Puis nous déclarons une méthode de test classique qui s&#8217;assure que le plugin est bien chargé par jQuery:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>   <span class="nx">test</span><span class="p">(</span><span class="s1">&#39;is plugin loaded in jQuery&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="nx">ok</span><span class="p">(</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">removableArea</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">),</span> <span class="s2">&quot;the plugin should be available from jQuery.fn&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ensuite, un petit test asynchrone qui se déroule en 3 temps:</p>

<ol>
<li>Déclaration d&#8217;un <code class='inline'>asyncTest</code>.</li>
<li>Définir le nombre d&#8217;assertion attendues via la fonction <code class='inline'>expected</code>.</li>
<li>Appeler la fonction <code class='inline'>start</code> une fois que le code asynchrone a été exécuté.</li>
</ol>


<p>Ce qui donne le test suivant, qui vérifie que le plugin a bien été chargé en écoutant l&#8217;événement d&#8217;initialisation:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>    <span class="nx">asyncTest</span><span class="p">(</span><span class="s2">&quot;does the plugin initialize&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">expect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">targets</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>   <span class="c1">//we expect 3 assertions, one by target</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">targets</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;init.removablearea&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>                <span class="nx">strictEqual</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.removable-ctrl&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">).</span><span class="nx">length</span><span class="p">);</span>
</span><span class='line'>                <span class="nx">start</span><span class="p">();</span>
</span><span class='line'>            <span class="p">});</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">targets</span><span class="p">.</span><span class="nx">removableArea</span><span class="p">();</span>
</span><span class='line'>    <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Pour lancer les tests, il suffit de charger la page HTML. Le résultat est visible depuis celle-ci, comme nous pouvons le voir sur la capture suivante:</p>

<p><img src="http://krampstudio.github.com/images/sc.test-result.png" title="Capture de la page de résultats tests" ></p>

<h2>Automatisation</h2>

<blockquote><p>Un makefile pour du Javascript ?</p>

<blockquote><p>C&#8217;est un peu l&#8217;idée oui!</p></blockquote></blockquote>

<p>Dans le but d&#8217;améliorer la qualité de nos développements et de gagner du temps, nous allons déléguer les tâches suivantes à un outils de build, <a href="http://www.gruntjs.org">Grunt</a> dont nous avons déjà parlé précédemment:</p>

<ul>
<li>Minimification des sources.</li>
<li>Ajout de la bannière de licence.</li>
<li>Exécution des tests.</li>
<li>Vérification du code.</li>
</ul>


<p>Pour faire tout cela, c&#8217;est simple nous utilisons les plugins fournis de base avec Grunt.</p>

<h3>Génération des sources finales</h3>

<p>Nous allons distribuer notre plugin sous forme minimifié, mais avec tout de même une bannière rappelant les informations essentielles: le copyright, l&#8217;auteur et la licence. Ces informations vont être extraites et formatées à partir du fichier de méta-données : <code class='inline'>package.json</code>. Ce fichier est bien sûr formaté en JSON et suit la convention de description de paquet <a href="http://www.npmjs.org">NPM</a> (les paquets node.js). Vous pouvez allez voir la <a href="https://npmjs.org/doc/json.html">spécification</a> pour plus de détails.</p>

<p>Dans le cas de notre plugin, les méta-données sont les suivantes:</p>

<div><script src='https://gist.github.com/4145261.js?file=package.json'></script>
<noscript><pre><code>{
    &quot;name&quot; : &quot;jQueryRemovableArea&quot;,
    &quot;description&quot;   : &quot;A plugin that enables you to remove a element from the page&quot;,
    &quot;version&quot;       : &quot;0.1.0&quot;,
    &quot;homepage&quot;      : &quot;https://github.com/krampstudio/jQueryRemovableArea&quot;,
    &quot;author&quot;: {
        &quot;name&quot;  : &quot;Bertrand Chevrier&quot;,
        &quot;email&quot; : &quot;chevrier.bertrand@gmail.com&quot;,
        &quot;url&quot;   : &quot;https://github.com/krampstudio&quot;
    },
    &quot;licenses&quot;: [{
        &quot;type&quot;: &quot;GPL&quot;,
        &quot;url&quot; : &quot;http://www.gnu.org/licenses/gpl-3.0.txt&quot;
      }
    ],
    &quot;repository&quot;: {
        &quot;type&quot; : &quot;git&quot;,
        &quot;url&quot;  : &quot;git://github.com/krampstudio/jQueryRemovableArea&quot;
    },
    &quot;dependencies&quot;: {
        &quot;jquery&quot;   : &quot;&gt;=1.7&quot;
    },
    &quot;devDependencies&quot;: {
        &quot;grunt&quot; : &quot;0.3.x&quot;,
        &quot;qunit&quot; : &quot;1.9.x&quot;
    }
}</code></pre></noscript></div>


<p>Maintenant nous souhaitons avoir en entête de nos sources le commentaire suivant:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> * Copyright (c) 2012 Bertrand Chevrier</span>
</span><span class='line'><span class="cm"> * jQueryRemovableArea - v0.1.0 </span>
</span><span class='line'><span class="cm"> * @author Bertrand Chevrier &lt;chevrier.bertrand@gmail.com&gt;</span>
</span><span class='line'><span class="cm"> * @license GPL  &lt;http://www.gnu.org/licenses/gpl-3.0.txt&gt;</span>
</span><span class='line'><span class="cm"> */</span>
</span></code></pre></td></tr></table></div></figure>


<p>Pour cela Grunt nous propose un mécanisme qui va nous permettre de récupérer le contenu du fichier <code class='inline'>package.json</code> et de l&#8217;utiliser au sein de notre fichier de build, via un mécanisme de template basique. De plus, Grunt a mis en place le concept de <code class='inline'>banner</code> qui pourra être concaténé avec notre fichier source.</p>

<p>Voici le fichier de build <code class='inline'>grunt.js</code> qui va minimifier les sources et créer l&#8217;entête:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>   <span class="nx">grunt</span><span class="p">.</span><span class="nx">initConfig</span><span class="p">({</span>
</span><span class='line'>        <span class="nx">pkg</span><span class="o">:</span> <span class="s1">&#39;&lt;json:package.json&gt;&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">meta</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">banner</span><span class="o">:</span> <span class="s1">&#39;/**\n&#39;</span><span class="o">+</span>
</span><span class='line'>                    <span class="s1">&#39; * Copyright (c) &lt;%= grunt.template.today(&quot;yyyy&quot;) %&gt; &lt;%= pkg.author.name %&gt;\n&#39;</span> <span class="o">+</span>
</span><span class='line'>                    <span class="s1">&#39; * &lt;%= pkg.name %&gt; - v&lt;%= pkg.version %&gt; \n&#39;</span> <span class="o">+</span>
</span><span class='line'>                    <span class="s1">&#39; * @author &lt;%= pkg.author.name %&gt; &lt;&lt;%= pkg.author.email %&gt;&gt;\n&#39;</span> <span class="o">+</span>
</span><span class='line'>                    <span class="s1">&#39; * @license &lt;%= pkg.licenses[0].type %&gt;  &lt;&lt;%= pkg.licenses[0].url %&gt;&gt;\n&#39;</span><span class="o">+</span>
</span><span class='line'>                    <span class="s1">&#39; */&#39;</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>        <span class="nx">min</span> <span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">dist</span> <span class="o">:</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">src</span><span class="o">:</span> <span class="s1">&#39;src/removablearea.js&#39;</span><span class="p">,</span>
</span><span class='line'>                <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;jquery.removablearea.min.js&#39;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>        <span class="nx">concat</span> <span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">dist</span> <span class="o">:</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">src</span> <span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;&lt;banner&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;jquery.removablearea.min.js&#39;</span><span class="p">],</span>
</span><span class='line'>                <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;jquery.removablearea.min.js&#39;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>La commande :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$&gt;</span> grunt min concat
</span></code></pre></td></tr></table></div></figure>


<p>va produire notre fichier final <code class='inline'>jquery.removablearea.min.js</code>.</p>

<h3>Tests et vérification</h3>

<p>Nous pouvons automatiser l&#8217;exécution des tests Qunit avec Grunt et PhantomJs. PhantomJs permet d&#8217;exécuter le test dans un navigateur en ligne de commande: il créé un navigateur de type WebKit en <em>headless</em>.</p>

<p>Pour la vérification du code source, nous utilisons <a href="http://www.jshint.com">JSHint</a> qui est plus flexible que <a href="http://www.jslint.com">JSLint</a>.</p>

<p>Puisque nous utilisons les plugins fournis par défaut avec Grunt, la configuration se résume à l&#8217;ajout d&#8217;un pattern pointant sur les fichiers de tests Qunit et la définition des règles JSHint.</p>

<p>Le fichier de build final ressemble à cela:</p>

<div><script src='https://gist.github.com/4145424.js?file=grunt.js'></script>
<noscript><pre><code>module.exports = function(grunt){
    grunt.initConfig({
        pkg: '&lt;json:package.json&gt;',
        meta: {
            banner: '/**\n'+
                    ' * Copyright (c) &lt;%= grunt.template.today(&quot;yyyy&quot;) %&gt; &lt;%= pkg.author.name %&gt;\n' +
                    ' * &lt;%= pkg.name %&gt; - v&lt;%= pkg.version %&gt; \n' +
                    ' * @author &lt;%= pkg.author.name %&gt; &lt;&lt;%= pkg.author.email %&gt;&gt;\n' +
                    ' * @license &lt;%= pkg.licenses[0].type %&gt;  &lt;&lt;%= pkg.licenses[0].url %&gt;&gt;\n'+
                    ' */'
        },
        min : {
            dist : {
                src: 'src/removablearea.js',
                dest: 'jquery.removablearea.min.js'
            }
        },
        concat : {
            dist : {
                src : [ '&lt;banner&gt;', 'jquery.removablearea.min.js'],
                dest: 'jquery.removablearea.min.js'
            }
        },
        qunit : {
            all : ['test/*.html']
        },
        lint : {
            files : ['src/*.js']
        },
        jshint : {
            options: {
                browser : true,
                smarttabs : true
            },
            globals: {
                jQuery : true
            }
        }
    });
    grunt.registerTask('default', 'lint qunit min concat');
};</code></pre></noscript></div>


<p>Et voici le genre de sortie que devrait retourner Grunt si tout se passe bien durant le build:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$&gt;</span> grunt
</span><span class='line'>Running <span class="s2">&quot;lint:files&quot;</span> <span class="o">(</span>lint<span class="o">)</span> task
</span><span class='line'>Lint free.
</span><span class='line'>
</span><span class='line'>Running <span class="s2">&quot;qunit:all&quot;</span> <span class="o">(</span>qunit<span class="o">)</span> task
</span><span class='line'>Testing removablearea.html....OK
</span><span class='line'>&gt;&gt; 6 assertions passed <span class="o">(</span>61ms<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>Running <span class="s2">&quot;min:dist&quot;</span> <span class="o">(</span>min<span class="o">)</span> task
</span><span class='line'>File <span class="s2">&quot;jquery.removablearea.min.js&quot;</span> created.
</span><span class='line'>Uncompressed size: 2001 bytes.
</span><span class='line'>Compressed size: 660 bytes gzipped <span class="o">(</span>1269 bytes minified<span class="o">)</span>.
</span><span class='line'>
</span><span class='line'>Running <span class="s2">&quot;concat:dist&quot;</span> <span class="o">(</span>concat<span class="o">)</span> task
</span><span class='line'>File <span class="s2">&quot;jquery.removablearea.min.js&quot;</span> created.
</span><span class='line'>
</span><span class='line'>Done, without errors.
</span></code></pre></td></tr></table></div></figure>


<h2>Partager</h2>

<blockquote><p>On va rentrer dans la postérité</p></blockquote>

<p>Bien que le <a href="http://plugins.jquery.com/">site</a> répertoriant les plugins JQuery soit <em>en cours de développement</em>, il nous donne déjà la procédure à suivre pour y inscrire notre plugin. Dès que le site sera fini, notre plugin devrait théoriquement parti de la liste, un très bon moyen pour le faire connaître et de le partager.</p>

<h3>Les méta-données</h3>

<p>Tout comme pour le build, nous devons créer un fichier qui va contenir les informations relatives à notre plugin. Ce fichier servira à fournir les informations nécessaires pour indexer le plugin. Ce fichier est très proche du fichier <code class='inline'>package.json</code> (car ils se sont inspirés de la spec NPM), mais trop différent pour n&#8217;utiliser qu&#8217;un seul fichier&#8230; En suivant le <a href="https://github.com/jquery/plugins.jquery.com/blob/master/docs/manifest.md">format spécifié</a>, voici à quoi ressemble ce fichier pour notre plugin:</p>

<div><script src='https://gist.github.com/4156975.js?file=removablearea.jquery.json'></script>
<noscript><pre><code>{
  &quot;name&quot;: &quot;removablearea&quot;,
  &quot;title&quot;: &quot;Removablearea&quot;,
  &quot;description&quot;: &quot;This plugin enables you to remove any area from a web page&quot;,
  &quot;version&quot;: &quot;0.1.0&quot;,
  &quot;homepage&quot;: &quot;https://github.com/krampstudio/jQueryRemovableArea&quot;,
  &quot;author&quot;: {
    &quot;name&quot;: &quot;Bertrand Chevrier&quot;,
    &quot;email&quot;: &quot;chevrier.bertrand@gmail.com&quot;,
    &quot;url&quot;: &quot;http://krampstudio.com&quot;
  },
  &quot;repository&quot;: {
    &quot;type&quot;: &quot;git&quot;,
    &quot;url&quot;: &quot;git://github.com/krampstudio/jQueryRemovableArea.git&quot;
  },
  &quot;bugs&quot;: {
    &quot;url&quot;: &quot;https://github.com/krampstudio/jQueryRemovableArea/issues&quot;
  },
  &quot;licenses&quot;: [
    {
      &quot;type&quot;: &quot;GPL&quot;,
      &quot;url&quot;: &quot;http://www.gnu.org/licenses/gpl-3.0.txt&quot;
    }
  ],
  &quot;dependencies&quot;: {
    &quot;jquery&quot;: &quot;1.7&quot;
  },
  &quot;keywords&quot;: [&quot;remove&quot;, &quot;delete&quot;]
}</code></pre></noscript></div>


<p>Bon, c&#8217;est un peu redondant avec le fichier <code class='inline'>package.json</code> et il est surement possible de le générer avec depuis celui-ci, d&#8217;ailleurs si quelqu&#8217;un le fait déjà n&#8217;hésitez pas à laisser un commentaire!</p>

<h3>Préparer l&#8217;indexation</h3>

<p>Pour préparer l&#8217;indexation sur le site <a href="http://plugins.jquery.com">plugins.jquery.com</a>, il suffit d&#8217;ajouter un <em>hook</em> sur notre dépôt Github, comme décrit le décrit cette <a href="https://github.com/jquery/plugins.jquery.com#how-to-list-a-plugin">procédure</a>. La capture suivante montre l&#8217;interface d&#8217;administration du projet sur Github qui permet de rajouter le hoot:</p>

<p><img src="http://krampstudio.github.com/images/sc.github-hook.png" title="Ajout d'un service hook dans l'administration du dépôt" ></p>

<h1>Et voilà</h1>

<blockquote><p>Un petit plugin jQuery aux petits oignons.</p></blockquote>

<p>Le code source de l&#8217;exemple est bien entendu disponible sur mon Github <a href="https://github.com/krampstudio/jQueryRemovableArea">krampstudio/jQueryRemovableArea</a>.</p>

<p><em>Enjoy javascript coding</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Et c'est parti avec octopress]]></title>
    <link href="http://krampstudio.github.com/blog/2012/09/13/et-cest-parti-avec-octopress/"/>
    <updated>2012-09-13T22:13:00+02:00</updated>
    <id>http://krampstudio.github.com/blog/2012/09/13/et-cest-parti-avec-octopress</id>
    <content type="html"><![CDATA[<p>Voilà c&#8217;est fait, cela faisait un petit moment que j&#8217;avais cette idée en tête, et deux jours d&#8217;arrêt maladie (obligé de rester à la maison parce que contagieux) m&#8217;ont permis de prendre quelques heures pour configurer et mettre en ligne ce blog, avec le moteur de génération de blog <a href="http://octopress.org">Octopress</a>.
Quand je dis quelques heures, c&#8217;est vraiement le cas. Octopress cible un public de <em>hackers</em> (le slogan étant <em>A blogging framework for hackers</em>), c&#8217;est à dire :</p>

<ul>
<li>sachant manipuler git et <a href="http://github.com">github</a></li>
<li>sachant lancer des commandes de build (rake en l&#8217;occurence)</li>
<li>et sachant éditer feuilles de style CSS, fichiers de configuration YAML et bien entendu des fichiers textes au micro-format Markdown</li>
</ul>


<!--more-->


<p>Bon, je tiens à vous le dire tout de suite, mieux vaut avoir un système d&#8217;exploitation adapté muni d&#8217;un Shell de type Bash, Zsh ou autre, sinon il va falloir bidouiller. En effet, Octopress nécessite une version particulière de Ruby qu&#8217;il faut gérer grâce à <a href="https://github.com/sstephenson/rbenv">rbenv</a> (qui permet de créer des environnements Ruby cloisonnés) qui n&#8217;est simplement pas fait pour tourner sur un OS comme Windows (ca fonctionne peut être avec cygwin). Dans mon cas ça tombe plutôt bien car je suis sous Linux, mais lorsque j&#8217;ai voulu faire un essai au boulot (durant ma pause déjeuné bien sûr), j&#8217;ai vite abandonné.</p>

<h3>Pourquoi Octopress?</h3>

<p>Mon choix c&#8217;est vite porté sur Octopress car la philosophie de l&#8217;outils me plaisait bien, notamment pour:</p>

<ul>
<li>La bonne intégration avec GitHub et <em>github-pages</em> qui permet de publier des ressources statiques sur Github, et ca tombe bien car Octopress est un générateur de site. Donc pas besoin d&#8217;héberger le blog, d&#8217;installer de serveur web, etc. tout est dans un dépôt de code GitHub. Bien entendu, comme le contenu n&#8217;est pas dynamique, il peut être facilement hébergé par n&#8217;importe quel serveur web.</li>
<li>Le fait d&#8217;éditer ses posts au format Markdown. Encore une fois, à force d&#8217;écrire des README, de la doc dans mes projets GitHub dans ce micro-format, et bien je m&#8217;y suis fait. Et franchement, même s&#8217;il est un peu limitatif, je n&#8217;ai pas besoin de plus.</li>
<li>Le théme de base est sympa. Il se customize simplement en éditant les feuilles de style. D&#8217;ailleurs, les CSS sont générés grâce depuis le framework <a href="http://sass-lang.com">SASS</a> qui offre des fonctionnalités qui manquent cruellement aux CSS: variables, mixins, héritage, etc. (ceux qui connaissent <a href="http://lesscss.org/">Less</a> ne seront pas dépaysés). Octopress utilise aussi <a href="http://compass-style.org/">Compass</a> qu&#8217;il faut plus voir comme une librairie d&#8217;utilitaire à SASS qu&#8217;une surcouche à la surcouche. Encore une fois je suis en terrain connu, car j&#8217;utilise ces deux framework pour un de mes projet perso.</li>
<li>Pour enrichir le blog, on peut avoir recours à des plugins. Il y en a déjà quelque-uns très sympa, et comme Octopress se base sur <a href="http://jekyllrb.com/">Jekyll</a> (le moteur de génération) on peut bénéficier de ses plugins. Sinon, quelques bribes de HTML/CSS/Javascript devraient suffir dans la plupart des cas.</li>
<li>Pour finir, le tout est codé en Ruby (Ocotpress, Jekyll, SASS, Compass), langage que je n&#8217;ai jamais abordé (j&#8217;ai juste passé quelques minutes sur <a href="http://rubymonk.com/">RubyMonk</a>, le super sexy online tutoriel) et ça peut être l&#8217;occasion de s&#8217;y mettre!</li>
<li>Le code est versionné de base, avec GIT. Les posts étant des fichiers Markdown avec header, la configuration dans des fichiers YAML, il n&#8217;y a pas de base de données, donc l&#8217;intégralité du blog: la structure et le contenu sont versionnés avec notre gestionnaire de version préféré ;).</li>
</ul>


<p>Donc voilà, je pense que dans quelques posts et tunning, je pourrais vous en dire plus, notamment sur les avantages/inconvénients, encore une fois en toute subjectivité.</p>
]]></content>
  </entry>
  
</feed>
